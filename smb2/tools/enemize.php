<?php

	$eid	= [
		0x00	=> 'Enemy_Heart',
		0x01	=> 'Enemy_ShyguyRed',
		0x02	=> 'Enemy_Tweeter',
		0x03	=> 'Enemy_ShyguyPink',
		0x04	=> 'Enemy_Porcupo',
		0x05	=> 'Enemy_SnifitRed',
		0x06	=> 'Enemy_SnifitGray',
		0x07	=> 'Enemy_SnifitPink',
		0x08	=> 'Enemy_Ostro',
		0x09	=> 'Enemy_BobOmb',
		0x0A	=> 'Enemy_AlbatossCarryingBobOmb',
		0x0B	=> 'Enemy_AlbatossStartRight',
		0x0C	=> 'Enemy_AlbatossStartLeft',
		0x0D	=> 'Enemy_NinjiRunning',
		0x0E	=> 'Enemy_NinjiJumping',
		0x0F	=> 'Enemy_BeezoDiving',
		0x10	=> 'Enemy_BeezoStraight',
		0x11	=> 'Enemy_WartBubble',
		0x12	=> 'Enemy_Pidgit',
		0x13	=> 'Enemy_Trouter',
		0x14	=> 'Enemy_Hoopstar',
		0x15	=> 'Enemy_JarGeneratorShyguy',
		0x16	=> 'Enemy_JarGeneratorBobOmb',
		0x17	=> 'Enemy_Phanto',
		0x18	=> 'Enemy_CobratJar',
		0x19	=> 'Enemy_CobratSand',
		0x1A	=> 'Enemy_Pokey',
		0x1B	=> 'Enemy_Bullet',
		0x1C	=> 'Enemy_Birdo',
		0x1D	=> 'Enemy_Mouser',
		0x1E	=> 'Enemy_Egg',
		0x1F	=> 'Enemy_Tryclyde',
		0x20	=> 'Enemy_Fireball',
		0x21	=> 'Enemy_Clawgrip',
		0x22	=> 'Enemy_ClawgripRock',
		0x23	=> 'Enemy_PanserStationaryFiresAngled',
		0x24	=> 'Enemy_PanserWalking',
		0x25	=> 'Enemy_PanserStationaryFiresUp',
		0x26	=> 'Enemy_Autobomb',
		0x27	=> 'Enemy_AutobombFire',
		0x28	=> 'Enemy_WhaleSpout',
		0x29	=> 'Enemy_Flurry',
		0x2A	=> 'Enemy_Fryguy',
		0x2B	=> 'Enemy_FryguySplit',
		0x2C	=> 'Enemy_Wart',
		0x2D	=> 'Enemy_HawkmouthBoss',
		0x2E	=> 'Enemy_Spark1',
		0x2F	=> 'Enemy_Spark2',
		0x30	=> 'Enemy_Spark3',
		0x31	=> 'Enemy_Spark4',
		0x32	=> 'Enemy_VegetableSmall',
		0x33	=> 'Enemy_VegetableLarge',
		0x34	=> 'Enemy_VegetableWart',
		0x35	=> 'Enemy_Shell',
		0x36	=> 'Enemy_Coin',
		0x37	=> 'Enemy_Bomb',
		0x38	=> 'Enemy_Rocket',
		0x39	=> 'Enemy_MushroomBlock',
		0x3A	=> 'Enemy_POWBlock',
		0x3B	=> 'Enemy_FallingLogs',
		0x3C	=> 'Enemy_SubspaceDoor',
		0x3D	=> 'Enemy_Key',
		0x3E	=> 'Enemy_SubspacePotion',
		0x3F	=> 'Enemy_Mushroom',
		0x40	=> 'Enemy_Mushroom1up',
		0x41	=> 'Enemy_FlyingCarpet',
		0x42	=> 'Enemy_HawkmouthRight',
		0x43	=> 'Enemy_HawkmouthLeft',
		0x44	=> 'Enemy_CrystalBall',
		0x45	=> 'Enemy_Starman',
		0x46	=> 'Enemy_Stopwatch',
		0x47	=> 'Enemy_AttackAlbatossCarryingBobOmb',
		0x48	=> 'Enemy_AttackBeezo',
		0x49	=> 'Enemy_StopAttack',
		0x4A	=> 'Enemy_VegetableThrower',
		0x4B	=> 'Enemy_4B',
		0x4C	=> 'Enemy_4C',
		0x4D	=> 'Enemy_4D',
		0x4E	=> 'Enemy_4E',
		0x4F	=> 'Enemy_4F',
		0x50	=> 'Enemy_50',
		0x51	=> 'Enemy_51',
		0x52	=> 'Enemy_52',
		0x53	=> 'Enemy_53',
		0x54	=> 'Enemy_54',
		0x55	=> 'Enemy_55',
		0x56	=> 'Enemy_56',
		0x57	=> 'Enemy_57',
		0x58	=> 'Enemy_58',
		0x59	=> 'Enemy_59',
		0x5A	=> 'Enemy_5A',
		0x5B	=> 'Enemy_5B',
		0x5C	=> 'Enemy_BossBirdo',
		0x5D	=> 'Enemy_BossMouser',
		0x5E	=> 'Enemy_BossEgg',
		0x5F	=> 'Enemy_BossTryclyde',
		0x60	=> 'Enemy_BossFireball',
		0x61	=> 'Enemy_BossClawgrip',
		0x62	=> 'Enemy_BossClawgripRock',
		0x63	=> 'Enemy_BossPanserStationaryFiresAngled',
		0x64	=> 'Enemy_BossPanserWalking',
		0x65	=> 'Enemy_BossPanserStationaryFiresUp',
		0x66	=> 'Enemy_BossAutobomb',
		0x67	=> 'Enemy_BossAutobombFire',
		0x68	=> 'Enemy_BossWhaleSpout',
		0x69	=> 'Enemy_BossFlurry',
		0x6A	=> 'Enemy_BossFryguy',
		0x6B	=> 'Enemy_BossFryguySplit',
		0x6C	=> 'Enemy_BossWart',
		0x6D	=> 'Enemy_BossHawkmouthBoss',
		0x6E	=> 'Enemy_BossSpark1',
		0x6F	=> 'Enemy_BossSpark2',
		0x70	=> 'Enemy_BossSpark3',
		0x71	=> 'Enemy_BossSpark4',
		0x72	=> 'Enemy_BossVegetableSmall',
		0x73	=> 'Enemy_BossVegetableLarge',
		0x74	=> 'Enemy_BossVegetableWart',
		0x75	=> 'Enemy_BossShell',
		0x76	=> 'Enemy_BossCoin',
		0x77	=> 'Enemy_BossBomb',
		0x78	=> 'Enemy_BossRocket',
		0x79	=> 'Enemy_BossMushroomBlock',
		0x7A	=> 'Enemy_BossPOWBlock',
		0x7B	=> 'Enemy_BossFallingLogs',
		0x7C	=> 'Enemy_BossSubspaceDoor',
		0x7D	=> 'Enemy_BossKey',
		0x7E	=> 'Enemy_BossSubspacePotion',
		0x7F	=> 'Enemy_BossMushroom',
		];



	$data	= <<<'E'
; Level 1-1, Area 1

EnemyData_Level_1_1_Area1:
      .BYTE $05,$14,$56,$14,$AD
      .BYTE $03,$03,$9D
      .BYTE $07,$0E,$83,$0E,$79,$03,$BC
      .BYTE $05,$0E,$90,$0E,$75
      .BYTE $01

E;

	$wM	= 7;
	$wS	= 1;
	$lM = 3;
	$lS = 1;
	$aM = 9;
	$aS = 0;


/*
	$wM=$wS = 2;
	$lM=$lS = 2;
	$aM=$aS = 2;
*/
	for ($w = $wS; $w <= $wM; $w++) {
		for ($l = $lS; $l <= $lM; $l++) {
			for ($a = $aS; $a <= $aM; $a++) {
				$filename	= sprintf("%d/%d-%d/%d-%d-area%d-enemies.asm", $w, $w, $l, $w, $l, $a);
				if (!file_exists($filename)) {
					continue;
				} else {
					print $filename ."\n";
					$data	= file_get_contents($filename);
					$newd	= itemize($data);
					file_put_contents($filename, $newd);
				}
			}
		}
	}

	//print $newd;

	function itemize($s) {
		global $eid;

		$x	= explode(":", $s);
		$z	= $x[1];

		$comments	= [];
		$commentT	= "";
		preg_match_all('/(;[^\n]+)/sim', $z, $comments);

		if (!empty($comments[0])) {
			$commentT	= "\n". implode("\n", $comments[0]) ."\n";
			print $commentT;
		}

		$z	= preg_replace('/(;[^\n]+|[,$\s]|\.BYTE)/sim', '', $z);
		//print $z ."\n";
		$iz		= str_split($z, 2);
		$page	= 0;
		$out	= $x[0] .":\n$commentT";

		while ($len = hexdec(array_shift($iz))) {
			$out	.= sprintf("\n; Page %X\n", $page);
			$out	.= sprintf("%s     distTo + ; \$%02X (%d enem%s)\n", ($page != 0 ? "+" : " "), $len, ($len - 1) / 2, (($len - 1) / 2) == 1 ? "y" : "ies");
			for ($pos = 1; $pos < $len; $pos += 2) {
				$e	= hexdec(array_shift($iz));
				$po	= hexdec(array_shift($iz));
				$out	.= sprintf("      enemy \$%X, \$%X, %s\n", ($po >> 4 & 0xF), ($po & 0xF), $eid[$e]);

			}
			$page++;

		}

		$out	.= "\n; End of enemy data\n+\n";
		return $out;
	}
